// Prisma schema for Sales feature (isolated client output)
// Uses its own schema path and generated client output to avoid touching the main Prisma setup.

generator client {
  provider = "prisma-client-js"
  // Generate into the feature directory to avoid conflicts with the main client
  output   = "../prisma/generated/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Sale {
  id            BigInt    @id @default(autoincrement())
  source        String
  orderNo       String?
  isbn          String?
  title         String?
  author        String?
  publisher     String?
  customerName  String?
  mobile        String?
  paymentMode   String?
  amount        Decimal?  @db.Decimal(12, 2)
  qty           Int?
  rate          Decimal?  @db.Decimal(12, 2)
  date          DateTime?
  rawJson       Json
  rowHash       String?   @unique
  createdAt     DateTime  @default(now())

  @@index([source])
  @@index([date])
}

// New table for Rajkamal-datas.xlsx with columns mirroring the sheet headers
model RkData {
  id                 BigInt    @id @default(autoincrement())
  slNo               Int?
  date               DateTime?
  orderId            String?
  orderStatus        String?
  isbn               String?
  title              String?
  author             String?
  category           String?
  publicationName    String?
  releaseDate        DateTime?
  noOfPages          Int?
  name               String?
  pincode            String?
  gender             String?
  ageGroup           String?
  mobile             String?
  email              String?
  membershipId       String?
  paymentMode        String?
  mrp                Decimal?  @db.Decimal(12, 2)
  sellingPrice       Decimal?  @db.Decimal(12, 2)
  discountCouponCode String?
  // Preserve original row and a deterministic hash for idempotency
  rawJson            Json
  rowHash            String?   @unique
  createdAt          DateTime  @default(now())

  @@index([date])
  @@index([orderId])
}
